<?xml version="1.0" encoding="UTF-8"?><record_update table="scan_table_check">
    <scan_table_check action="INSERT_OR_UPDATE">
        <active>true</active>
        <advanced>true</advanced>
        <category>code_sanity</category>
        <conditions/>
        <description>A Flow, Subflow or Flow Action should never depend on specific data records. This follows the doctrine that no code should ever depend on data.</description>
        <documentation_url/>
        <finding_type>scan_finding</finding_type>
        <name>CodeSanity - Flow depends on data</name>
        <priority>1</priority>
        <resolution_details>Modify the Flow, Subflow or Flow Action logic so that it does not depend on specific data records. If specific data records (users, groups, departments, etc.) are relevant for the flow logic, these must be loaded dynamically or configured explicitly - e.g. using System Properties.</resolution_details>
        <run_condition/>
        <score_max>100</score_max>
        <score_min>0</score_min>
        <score_scale>1</score_scale>
        <script><![CDATA[(function (engine) {

	if (x_snc_codesanity.IsCheckApplicableToRecord())
	{
		var strValue = GetStringValue(current.value);
		var aSysIds = x_snc_devtools.GetSysIdsFromString(strValue);
		var bDataRecordFound = false;
		for (var nSysId = 0; nSysId < aSysIds.length; nSysId++)
		{
			var strSysId = aSysIds[nSysId];
			if (x_snc_devtools.IsDataRecord(strSysId) == true)
			{
				bDataRecordFound = true;
			}
		}
		if (bDataRecordFound == true)
		{
			engine.finding.increment();
		}
	}

})(engine);]]></script>
        <short_description>Flows must not depend on data</short_description>
        <sys_class_name>scan_table_check</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-26 12:14:11</sys_created_on>
        <sys_id>507993de3ba7661062bf612c95e45a95</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>CodeSanity - Flow depends on data</sys_name>
        <sys_package display_value="DevTools WORK IN PROGRESS" source="x_snc_devtools">d689f6901bd38450a89720a8ec4bcbfd</sys_package>
        <sys_policy/>
        <sys_scope display_value="DevTools WORK IN PROGRESS">d689f6901bd38450a89720a8ec4bcbfd</sys_scope>
        <sys_update_name>scan_table_check_507993de3ba7661062bf612c95e45a95</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-26 12:14:11</sys_updated_on>
        <table>sys_variable_value</table>
        <use_manifest>false</use_manifest>
    </scan_table_check>
    <sys_translated_text action="delete_multiple" query="documentkey=507993de3ba7661062bf612c95e45a95"/>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>507993de3ba7661062bf612c95e45a95</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-26 12:14:10</sys_created_on>
        <sys_id>a64b9bde3ba7661062bf612c95e45a92</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-26 12:14:10</sys_updated_on>
        <table>scan_table_check</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
